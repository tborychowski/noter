<script>
import CommandPalette from './command-palette';
import {Data, Store} from '../data';

export default {
	store: () => Store,
	oncreate () {
		const palette = new CommandPalette({
			searchInFields: ['title', 'text'],
			dataSrc: this.getNotes.bind(this),
			sizeContainer: 'body',
			itemRenderer: ({title, text, highlighted}) => {
				if (highlighted) {
					if (highlighted.title) title = highlighted.title;
					if (highlighted.text) text = highlighted.text;
				}
				return `<div class="item-name">${title}</div>
					<span class="item-sub">${text}</span>`;
			}
		});

		palette.on('action', this.onNoteSelect.bind(this));
	},
	methods: {
		getNotes () {
			return this.store.get().notes;
		},

		onNoteSelect (note) {
			this.store.set({ note });
		}
	}
};
</script>
